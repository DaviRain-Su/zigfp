# Story: v1.4.0 项目结构重组

> 将 60+ 扁平源文件重组为 13 个模块化子目录，提升代码组织性和可维护性。

## 目标

1. 重构 `src/` 目录结构为模块化架构
2. 为每个子目录创建 `mod.zig` 模块入口
3. 更新 `root.zig` 和 `prelude.zig` 使用新结构
4. 重组 `docs/` 目录镜像 `src/` 结构
5. 修复所有跨模块导入路径
6. 确保 CI 构建和所有测试通过

## 验收标准

### 源代码结构 (src/)

- [x] 创建 `core/` 目录 (option, result, lazy, validation)
- [x] 创建 `monad/` 目录 (reader, writer, state, cont, free, mtl, selective)
- [x] 创建 `functor/` 目录 (functor, applicative, bifunctor, profunctor, distributive)
- [x] 创建 `algebra/` 目录 (semigroup, monoid, alternative, foldable, traversable, category)
- [x] 创建 `data/` 目录 (stream, zipper, iterator, arrow, comonad)
- [x] 创建 `function/` 目录 (function, pipe, memoize)
- [x] 创建 `effect/` 目录 (effect, io, file_system, random, time, config)
- [x] 创建 `parser/` 目录 (parser, json, codec)
- [x] 创建 `network/` 目录 (tcp, udp, websocket, http, connection_pool, network)
- [x] 创建 `resilience/` 目录 (retry, circuit_breaker, bulkhead, timeout, fallback)
- [x] 创建 `concurrent/` 目录 (parallel, benchmark)
- [x] 创建 `util/` 目录 (auth, i18n, schema)
- [x] 创建 `optics/` 目录 (lens, optics)

### 模块入口文件 (mod.zig)

- [x] `core/mod.zig` - 核心类型模块入口
- [x] `monad/mod.zig` - Monad 模块入口
- [x] `functor/mod.zig` - Functor 模块入口
- [x] `algebra/mod.zig` - 代数结构模块入口
- [x] `data/mod.zig` - 数据结构模块入口
- [x] `function/mod.zig` - 函数工具模块入口
- [x] `effect/mod.zig` - Effect 系统模块入口
- [x] `parser/mod.zig` - 解析器模块入口
- [x] `network/mod.zig` - 网络模块入口
- [x] `resilience/mod.zig` - 弹性模式模块入口
- [x] `concurrent/mod.zig` - 并发模块入口
- [x] `util/mod.zig` - 工具模块入口
- [x] `optics/mod.zig` - 光学模块入口

### 跨模块导入修复

- [x] `algebra/alternative.zig` - 修复 Option 导入路径
- [x] `algebra/traversable.zig` - 修复 Option/Functor 导入路径
- [x] `algebra/category.zig` - 修复 Function 导入路径
- [x] `functor/functor.zig` - 修复 Option 导入路径
- [x] `functor/profunctor.zig` - 修复 Function 导入路径
- [x] `functor/distributive.zig` - 修复 Functor/Function 导入路径
- [x] `monad/writer.zig` - 修复 Monoid 导入路径
- [x] `monad/selective.zig` - 修复 Functor/Function 导入路径
- [x] `monad/mtl.zig` - 修复多个导入路径
- [x] `data/stream.zig` - 修复 Option/Functor 导入路径
- [x] `data/zipper.zig` - 修复 Option/Functor 导入路径
- [x] `data/iterator.zig` - 修复 Option/Function 导入路径
- [x] `optics/optics.zig` - 修复 Lens/Function 导入路径
- [x] `network/http.zig` - 修复 Result/Option 导入路径
- [x] `util/schema.zig` - 修复 Result/Validation 导入路径
- [x] `concurrent/benchmark.zig` - 修复 Function 导入路径

### 入口文件更新

- [x] `src/root.zig` - 重写为模块化导入
- [x] `src/prelude.zig` - 更新导入路径
- [x] 添加缺失的 API 导出 (sumMonoid, productMonoid, ask, asks, tell, get, modify)

### 文档结构 (docs/)

- [x] 创建 `docs/core/README.md`
- [x] 创建 `docs/monad/README.md`
- [x] 创建 `docs/functor/README.md`
- [x] 创建 `docs/algebra/README.md`
- [x] 创建 `docs/data/README.md`
- [x] 创建 `docs/function/README.md`
- [x] 创建 `docs/effect/README.md`
- [x] 创建 `docs/parser/README.md`
- [x] 创建 `docs/network/README.md`
- [x] 创建 `docs/resilience/README.md`
- [x] 创建 `docs/concurrent/README.md`
- [x] 创建 `docs/util/README.md`
- [x] 创建 `docs/optics/README.md`
- [x] 移动现有 `.md` 文件到对应子目录

### 构建和测试

- [x] `zig build test` 通过 (734 tests)
- [x] `zig fmt --check src/` 通过
- [x] 所有 4 个示例构建成功
- [x] `examples/prelude_example.zig` 导入修复
- [x] `build.zig` 添加 prelude_example 目标
- [x] `.github/workflows/ci.yml` 添加 prelude example 构建步骤

### ROADMAP 更新

- [x] 更新项目结构说明
- [x] 更新文档链接

## 新目录结构

```
src/
├── root.zig              # 主入口，聚合所有模块
├── prelude.zig           # 常用类型预导入
├── core/                 # 核心类型
│   ├── mod.zig
│   ├── option.zig
│   ├── result.zig
│   ├── lazy.zig
│   └── validation.zig
├── monad/                # Monad 类型
│   ├── mod.zig
│   ├── reader.zig
│   ├── writer.zig
│   ├── state.zig
│   ├── cont.zig
│   ├── free.zig
│   ├── mtl.zig
│   └── selective.zig
├── functor/              # Functor 相关
│   ├── mod.zig
│   ├── functor.zig
│   ├── applicative.zig
│   ├── bifunctor.zig
│   ├── profunctor.zig
│   └── distributive.zig
├── algebra/              # 代数结构
│   ├── mod.zig
│   ├── semigroup.zig
│   ├── monoid.zig
│   ├── alternative.zig
│   ├── foldable.zig
│   ├── traversable.zig
│   └── category.zig
├── data/                 # 数据结构
│   ├── mod.zig
│   ├── stream.zig
│   ├── zipper.zig
│   ├── iterator.zig
│   ├── arrow.zig
│   └── comonad.zig
├── function/             # 函数工具
│   ├── mod.zig
│   ├── function.zig
│   ├── pipe.zig
│   └── memoize.zig
├── effect/               # Effect 系统
│   ├── mod.zig
│   ├── effect.zig
│   ├── io.zig
│   ├── file_system.zig
│   ├── random.zig
│   ├── time.zig
│   └── config.zig
├── parser/               # 解析器
│   ├── mod.zig
│   ├── parser.zig
│   ├── json.zig
│   └── codec.zig
├── network/              # 网络
│   ├── mod.zig
│   ├── tcp.zig
│   ├── udp.zig
│   ├── websocket.zig
│   ├── http.zig
│   ├── connection_pool.zig
│   └── network.zig
├── resilience/           # 弹性模式
│   ├── mod.zig
│   ├── retry.zig
│   ├── circuit_breaker.zig
│   ├── bulkhead.zig
│   ├── timeout.zig
│   └── fallback.zig
├── concurrent/           # 并发
│   ├── mod.zig
│   ├── parallel.zig
│   └── benchmark.zig
├── util/                 # 工具
│   ├── mod.zig
│   ├── auth.zig
│   ├── i18n.zig
│   └── schema.zig
└── optics/               # 光学
    ├── mod.zig
    ├── lens.zig
    └── optics.zig
```

## 完成状态

- 开始日期: 2026-01-02
- 完成日期: 2026-01-02
- 状态: ✅ 已完成
