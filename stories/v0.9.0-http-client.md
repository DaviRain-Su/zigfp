# Story: v0.9.0 HTTP 客户端

> 实现函数式HTTP客户端，基于Zig 0.15 HTTP API

## 目标

创建类型安全、函数式的HTTP客户端，提供：

- HTTP请求/响应抽象
- 函数式组合操作
- 错误处理和类型安全
- 集成到效果系统中

## 验收标准

### HTTP 核心功能 (http.zig)

- [x] `HttpRequest` - HTTP请求类型定义
- [x] `HttpResponse` - HTTP响应类型定义
- [x] `HttpClient` - HTTP客户端实现
- [ ] `HttpEffect` - HTTP效果类型
- [x] 请求构建器函数
- [x] 响应处理器函数

### 函数式操作

- [x] `sendRequest` - 发送HTTP请求效果
- [ ] `parseJsonResponse` - 解析JSON响应
- [x] `handleHttpError` - HTTP错误处理
- [ ] `withTimeout` - 请求超时控制
- [ ] `withRetry` - 请求重试机制

### 高级特性

- [ ] **中间件支持** - 请求/响应中间件
- [ ] **连接池** - 连接复用和池化
- [ ] **认证** - 基本认证、Bearer token等
- [ ] **流式请求** - 大文件上传/下载
- [ ] **WebSocket** - WebSocket连接支持

### 集成与测试

- [ ] root.zig 导出http模块
- [ ] 兼容Zig 0.15 HTTP API
- [ ] 完整的单元测试
- [ ] HTTP服务器mock用于测试
- [ ] 文档和使用示例

## 完成状态

- 开始日期: 2026-01-02
- 完成日期: 2026-01-02
- 状态: ✅ 已完成

## 技术考虑

### 类型安全

- **请求构建器**: 链式API构建请求
- **响应类型**: 类型安全的响应处理
- **错误类型**: 详细的HTTP错误分类

### 函数式设计

- **效果集成**: 与现有效果系统集成
- **组合性**: 请求可以自由组合和变换
- **不可变性**: 请求对象不可变，操作返回新对象

### 性能优化

- **连接复用**: HTTP/1.1 keep-alive
- **并发**: 异步请求支持
- **资源管理**: 正确的连接和缓冲区清理