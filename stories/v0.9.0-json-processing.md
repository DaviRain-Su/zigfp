# Story: v0.9.0 JSON 处理

> 实现函数式JSON编解码器

## 目标

创建类型安全、函数式的JSON处理库，提供：

- JSON解析和序列化
- 类型安全的JSON访问
- 函数式组合操作
- 错误处理和验证

## 验收标准

### JSON 核心功能 (json.zig)

- [x] `JsonValue` - JSON值类型定义
- [x] `parseJson` - JSON字符串解析
- [x] `stringifyJson` - JSON值序列化
- [x] `JsonPath` - 函数式JSON路径访问
- [x] 类型安全的访问器函数

### 函数式操作

- [x] `mapJson` - JSON值映射
- [x] `filterJson` - JSON数组过滤
- [x] `foldJson` - JSON值折叠
- [x] `transformJson` - JSON结构变换
- [x] `JsonPipeline` - 组合式操作链

### 高级特性

- [x] **mergeJson** - JSON对象合并
- [x] **pluckJson** - 从数组中提取字段
- [x] **groupByJson** - 按字段分组
- [ ] **Schema验证** - JSON Schema支持 (未来版本)
- [ ] **流式解析** - 大文件处理 (未来版本)

### 集成与测试

- [x] root.zig 导出json模块
- [x] 兼容std.json但提供函数式接口
- [x] 完整的单元测试
- [x] 文档和使用示例

## 完成状态

- 开始日期: 2026-01-02
- 完成日期: 2026-01-02
- 状态: ✅ 已完成

## 实现总结

### 已实现的功能

1. **transformJson**: 递归JSON结构变换
2. **JsonPipeline**: 函数式组合管道
3. **mergeJson**: 合并两个JSON对象
4. **pluckJson**: 从对象数组中提取指定字段
5. **groupByJson**: 按字段值分组数组元素

## 技术考虑

### 类型安全

- **编译时验证**: 利用Zig类型系统防止运行时错误
- **可选类型**: 使用Option处理缺失字段
- **联合类型**: 准确表示JSON类型变体

### 函数式设计

- **不可变性**: 操作不修改原始JSON
- **组合性**: 函数可以自由组合
- **惰性求值**: 支持流式和延迟操作

### 性能优化

- **零拷贝**: 尽可能避免内存复制
- **缓冲区重用**: 重复使用解析缓冲区

### 错误处理

- **精确错误**: 提供详细的解析错误信息
- **恢复策略**: 支持部分解析和错误恢复
- **上下文信息**: 错误位置和预期类型信息
